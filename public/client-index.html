<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>第三方平台首页</title>
    </head>
    <body>
        <div id="app">
            <p>token： {{ token }}</p>

            <button type="button" @click="getAppname">
                测试带token获取数据
            </button>
            <input type="text" v-model="appName" />
        </div>

        <script src="https://cdn.jsdelivr.net/npm/vue"></script>
        <script src="https://cdn.bootcss.com/axios/0.19.0/axios.min.js"></script>
        <script>
            const vm = new Vue({
                el: '#app',
                data() {
                    return {
                        token: '',
                        appName: ''
                    };
                },
                created() {
                    const that = this;
                    axios
                        .post('/api/token', {
                            name: 'test',
                            pswd: '123',
                            grant_type: 'password',
                            client_id: '3gwyuf0slaw02sfa848n',
                            client_secret: 'f18229f176a57e86f6d96246c09ec01a'
                        })
                        .then(function(response) {
                            console.log(response);
                            alert('获取成功');
                            that.token = response.data.token;
                        })
                        .catch(function(error) {
                            console.log(error);
                        })
                        .finally(function() {
                            // always executed
                        });
                },
                methods: {
                    getAppname() {
                        axios
                            .get('/api/getAppName?token=' + this.token)
                            .then(function(response) {
                                console.log(response);
                                alert('获取成功');
                                that.appName = response.data.getAppName;
                            })
                            .catch(function(error) {
                                console.log(error);
                            })
                            .finally(function() {
                                // always executed
                            });
                    }
                }
            });
        </script>
    </body>
</html>
